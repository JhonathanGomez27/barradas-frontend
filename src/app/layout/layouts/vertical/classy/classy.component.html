<!-- Loading bar -->
<fuse-loading-bar></fuse-loading-bar>

<!-- Navigation -->
<fuse-vertical-navigation class="dark bg-gradient-to-b from-barradas-900 to-barradas-700 print:hidden shadow-2xl"
    [mode]="isScreenSmall ? 'over' : 'side'" [name]="'mainNavigation'" [navigation]="navigation.default"
    [opened]="!isScreenSmall">
    <!-- Navigation header hook -->
    <ng-container fuseVerticalNavigationContentHeader>
        <!-- Logo Section -->
        <div class="flex items-center justify-between pt-8 pb-4">
            <img class="w-32" src="images/logo/credi_consumo_blanco.png" alt="Logo" />

            <!-- Components -->
            <div class="flex items-center">
                <div class="rounded-lg p-4 transition-all duration-300">
                    <user [showAvatar]="false"></user>
                </div>
            </div>
        </div>

        <!-- User Profile Section -->
        <div class="flex w-full flex-col items-center p-4">
            <!-- Avatar -->
            <div class="relative h-20 w-20 cursor-pointer transition-transform duration-300 hover:scale-105">
                @if (user.avatar) {
                <img class="h-full w-full rounded-full object-cover ring-2 ring-barradas-100/20" [src]="user.avatar"
                    alt="User avatar" />
                }
                @if (!user.avatar) {
                <div
                    class="flex h-full w-full items-center justify-center rounded-full bg-barradas-800 text-barradas-100 ring-2 ring-barradas-100/20">
                    <mat-icon class="icon-size-10" [svgIcon]="'heroicons_solid:user-circle'"></mat-icon>
                </div>
                }
                <!-- Online Status -->
                <div class="absolute bottom-0 right-0 h-4 w-4 rounded-full border-2 border-barradas-900 bg-green-500">
                </div>
            </div>

            <!-- User Info -->
            <div class="mt-3 flex w-full flex-col items-center justify-center">
                <div class="w-full truncate text-center text-base font-semibold text-white">
                    {{ user.name }}
                </div>
                <div class="w-full truncate text-center text-sm font-medium text-barradas-300">
                    {{ user.email }}
                </div>
            </div>

            @if (user?.rol === 'agent') {
            <div class="mt-4 w-full rounded-xl border border-white/10 bg-white/5 p-4 text-center backdrop-blur">
                <div class="text-xs font-semibold uppercase tracking-wide text-barradas-200">Tienda asignada</div>
                <div class="mt-1 text-base font-semibold text-white">
                    {{ user.storeName || 'Sin tienda asignada' }}
                </div>
                <div class="text-sm text-barradas-200">
                    {{ user.storeCity || 'Ciudad por confirmar' }}
                </div>
            </div>
            }
        </div>
    </ng-container>
    <!-- Navigation footer hook -->
    <!-- <ng-container fuseVerticalNavigationContentFooter>
        <div
            class="mb-4 mt-2 flex h-16 flex-0 items-center justify-center pl-2 pr-6 opacity-12"
        >
            <img class="max-w-36" src="images/logo/logo-text-on-dark.svg" />
        </div>
    </ng-container> -->
</fuse-vertical-navigation>

<!-- Wrapper -->
<div class="flex w-full min-w-0 flex-auto flex-col">
    <!-- Header -->
    <div
        class="bg-barradas-50 relative z-49 flex h-16 w-full flex-0 items-center px-4 shadow-lg border-b border-gray-200 dark:border-b dark:bg-transparent dark:shadow-none md:px-6 print:hidden backdrop-blur-sm bg-barradas-50/95">
        <!-- Navigation toggle button -->
        <button mat-icon-button (click)="toggleNavigation('mainNavigation')"
            class="transition-all duration-300 hover:bg-barradas-300/20 hover:text-barradas-700 rounded-lg p-2 group">
            <mat-icon [svgIcon]="'heroicons_outline:bars-3'"
                class="transition-transform duration-300 group-hover:scale-110">
            </mat-icon>
        </button>

        <!-- Breadcrumb or Page Title (Optional Enhancement) -->
        <!-- <div class="ml-4 hidden md:flex items-center space-x-2 text-gray-600">
            <mat-icon class="text-primary-500" style="font-size: 20px;">dashboard</mat-icon>
            <span class="font-medium">Panel de Control</span>
        </div> -->

        <!-- Components -->
        <div class="ml-auto flex items-center space-x-2 pl-2">
            <!-- Search Button -->
            <!-- <button
                mat-icon-button
                class="hidden sm:flex transition-all duration-300 hover:bg-gray-100 rounded-lg group"
                matTooltip="Buscar">
                <mat-icon
                    class="text-gray-600 group-hover:text-primary-600 transition-colors duration-300"
                    style="font-size: 20px;">search</mat-icon>
            </button> -->

            <!-- Notifications Button -->
            <!-- <button
                mat-icon-button
                class="hidden sm:flex transition-all duration-300 hover:bg-gray-100 rounded-lg relative group"
                matTooltip="Notificaciones">
                <mat-icon
                    class="text-gray-600 group-hover:text-primary-600 transition-colors duration-300"
                    style="font-size: 20px;">notifications</mat-icon>
                <span class="absolute top-1 right-1 h-3 w-3 bg-red-500 rounded-full border-2 border-white">
                    <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span>
                </span>
            </button> -->

            <!-- Fullscreen Toggle -->
            <div class="hidden md:block bg-white rounded-lg p-1 transition-all duration-300 hover:bg-barradas-300/20">
                <fuse-fullscreen></fuse-fullscreen>
            </div>

            <!-- Settings Button -->
            <!-- <button
                mat-icon-button
                class="transition-all duration-300 hover:bg-gray-100 rounded-lg group"
                matTooltip="ConfiguraciÃ³n">
                <mat-icon
                    class="text-gray-600 group-hover:text-primary-600 transition-colors duration-300"
                    style="font-size: 20px;">settings</mat-icon>
            </button> -->
        </div>
    </div>

    <!-- Content -->
    <div class="flex flex-auto flex-col">
        <!-- *ngIf="true" hack is required here for router-outlet to work correctly.
             Otherwise, layout changes won't be registered and the view won't be updated! -->
        @if (true) {
        <router-outlet></router-outlet>
        }
    </div>

    <!-- Footer -->
    <!--<div class="relative flex flex-0 items-center justify-start w-full h-14 px-4 md:px-6 z-49 border-t bg-card dark:bg-transparent print:hidden">
        <span class="font-medium text-secondary">Fuse &copy; {{currentYear}}</span>
    </div> -->
</div>

<!-- Quick chat -->
<!-- <quick-chat #quickChat="quickChat"></quick-chat> -->
